decisions:
  - phase_transition: "git-archaeology"
    decision: "Rewrite from legacy script to Rust workspace"
    reasoning: "Commit 92d1d04 'init rust workspace and archive legacy script' shows a deliberate migration from a scripting approach (likely shell/Python) to a Rust workspace, indicating a major language and architecture decision. The prior commit a303a77 'first init automation idea' was the original prototype."
    confidence: "high"
    revisit_trigger: "If team expertise shifts away from Rust or if compilation times become a bottleneck for rapid iteration"
    decided_by: "git-archaeology"
    timestamp: "unknown - early project history"

  - phase_transition: "git-archaeology"
    decision: "AI provider registry with pluggable multi-provider architecture"
    reasoning: "Commit 796a07e 'implement AI registry and Claude provider' introduces an abstraction layer for AI providers, followed by 8aa085a 'MS3-MS5: 多Provider支持' confirming multi-provider support. This registry pattern decouples the core system from any single LLM vendor."
    confidence: "high"
    revisit_trigger: "If provider APIs converge to a standard interface or if the abstraction adds unnecessary complexity for a single-provider use case"
    decided_by: "git-archaeology"
    timestamp: "unknown - phase 1"

  - phase_transition: "git-archaeology"
    decision: "Phased diverge/converge workflow as core architectural pattern"
    reasoning: "Commits 27850a5, f37ecc8, and 96390b9 implement diverge, diverge-validate, converge, and converge-validate commands. This suggests a deliberate split-then-merge workflow pattern (possibly for parallel AI-assisted code generation), which is a fundamental design choice shaping the entire CLI."
    confidence: "high"
    revisit_trigger: "If the diverge/converge model proves too complex for users or if a simpler linear workflow suffices"
    decided_by: "git-archaeology"
    timestamp: "unknown - phase 2"

  - phase_transition: "git-archaeology"
    decision: "Tera-based prompt template system"
    reasoning: "Commit b151b44 'implement MS3 prompt system with Tera templates' explicitly adopts Tera as the templating engine for prompts. This is a significant dependency choice that determines how prompts are composed, parameterized, and maintained."
    confidence: "high"
    revisit_trigger: "If Tera becomes unmaintained, or if prompt complexity requires features Tera doesn't support (e.g., async rendering, complex logic)"
    decided_by: "git-archaeology"
    timestamp: "unknown - MS3"

  - phase_transition: "git-archaeology"
    decision: "Pass Engine as core execution architecture"
    reasoning: "Commit 5a59b44 'feat(MS7): Pass Engine 核心架构' introduces a 'Pass Engine' — a compiler-pass-style architecture where operations are structured as sequential or composable passes. This is a major architectural pattern choice affecting extensibility and execution flow."
    confidence: "high"
    revisit_trigger: "If pass ordering becomes difficult to manage or if a DAG-based execution model would better serve complex workflows"
    decided_by: "git-archaeology"
    timestamp: "unknown - MS7"

  - phase_transition: "git-archaeology"
    decision: "Skeleton command pattern with validation"
    reasoning: "Commits f6d2081 and 1c7e5ad implement skeleton and skeleton-validate commands. The consistent pattern of pairing generation commands with validation commands (skeleton-validate, diverge-validate, converge-validate, seed-validate) reveals a deliberate architectural decision to make every generative step verifiable."
    confidence: "high"
    revisit_trigger: "If validation overhead slows down workflows or if users bypass validation steps consistently"
    decided_by: "git-archaeology"
    timestamp: "unknown - phase 3"

  - phase_transition: "git-archaeology"
    decision: "Massive subcommand-rich CLI design (21+ subcommands)"
    reasoning: "Commit 679bb14 'implement MS1, MS1.5, MS2 milestones — 21 subcommands' shows a deliberate choice to build a feature-rich CLI with many specialized subcommands rather than a minimal interface with flags/modes. This suggests a git-like CLI philosophy."
    confidence: "high"
    revisit_trigger: "If user onboarding suffers due to command discoverability, or if commands should be consolidated into fewer top-level entries with subcommand groups"
    decided_by: "git-archaeology"
    timestamp: "unknown - MS1-MS2"

  - phase_transition: "git-archaeology"
    decision: "Stdin-based prompt passing to Claude CLI to avoid OS limits"
    reasoning: "Commit a3900db 'use stdin for prompt to avoid ARG_MAX limit' shows a pragmatic fix where prompts are piped via stdin instead of command-line arguments. This reveals that prompts can be very large (exceeding ARG_MAX ~2MB), which is an important constraint shaping the IPC design."
    confidence: "high"
    revisit_trigger: "If switching to an HTTP API-based provider interface that doesn't go through CLI invocation"
    decided_by: "git-archaeology"
    timestamp: "unknown - latest commits"

  - phase_transition: "git-archaeology"
    decision: "Code generation and automated checks toolchain"
    reasoning: "Commit 0d453dd 'feat(MS6): Generators & Checks 自动化工具链' introduces automated generators and checks, suggesting a decision to build self-validating tooling — possibly code generators for boilerplate and automated quality checks as first-class features of the system."
    confidence: "medium"
    revisit_trigger: "If generated code diverges from actual patterns or if maintenance of generators becomes a burden"
    decided_by: "git-archaeology"
    timestamp: "unknown - MS6"

  - phase_transition: "git-archaeology"
    decision: "Iterative code review driven refactoring as development methodology"
    reasoning: "Multiple commits (552b0e0, a5ff999, 32391c6, 85679ac, 96390b9, 1c7e5ad) show systematic code review rounds addressing naming conventions, API key security, typed validation, utility extraction, and Arc::clone patterns. This reveals a disciplined review process that shaped API design incrementally — notably including secure API key handling (32391c6) as a review-driven security decision."
    confidence: "medium"
    revisit_trigger: "If the review process becomes a bottleneck or if architectural decisions need to be made more proactively rather than reactively"
    decided_by: "git-archaeology"
    timestamp: "unknown - throughout phases 1-3"